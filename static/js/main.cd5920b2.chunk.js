(this.webpackJsonptigery=this.webpackJsonptigery||[]).push([[0],{227:function(e,t,n){},231:function(e,t,n){},237:function(e,t){},239:function(e,t){},251:function(e,t){},253:function(e,t){},281:function(e,t){},283:function(e,t){},284:function(e,t){},289:function(e,t){},291:function(e,t){},310:function(e,t){},322:function(e,t){},325:function(e,t){},344:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(20),o=n.n(c),i=(n(227),n(40)),s=(n(231),n(31)),u=n(77),l=n(201),d=n(211),b=n(24),j=n(10),f=n.n(j),h=n(68),p=n(202),m=n(203),O=function(){return Object(p.a)({domain:"hacks.au.auth0.com",client_id:"S8N9i0qIl2MuQjUHiGPDHsdDDeqDMx4k",redirect_uri:"https://hackle.github.io/leisurely-react-and-typescript-at-odd-hours/#/login/callback",audience:"https://api.reactoddhours.com:3001/"})};function g(){return v.apply(this,arguments)}function v(){return(v=Object(b.a)(f.a.mark((function e(){var t,n,r,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O();case 2:return n=e.sent,e.next=5,n.getUser();case 5:if(null!=(r=e.sent)){e.next=8;break}return e.abrupt("return",void 0);case 8:return e.next=10,n.getTokenSilently();case 10:return a=e.sent,e.abrupt("return",{name:null!==(t=r.name)&&void 0!==t?t:"Unnamed",picture:r.picture,permissions:x(a),authToken:a});case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e){var t=Object(m.decode)(null!==e&&void 0!==e?e:"");return null==t||"string"===typeof t?[]:(null!==t&&void 0!==t?t:{}).permissions}var y={images:["https://pixabay.com/get/ga318fb8d1c3715c18097c4ad946803440a20b71426f074669ad38ae61a09c3ee1208741c4e9f3737faaa0e518ffd5c2b193167fefdf50d090cf1fad1a4ad4d3c_640.jpg","https://pixabay.com/get/ge1fa64bb0436c6ea7e582e146c576d4326b604bf9f097c983801d168bccc221f3783292264980044dbf31a10c7cfd3227958468ccd8ccf9d149e75e8ee1319ca_640.jpg","https://pixabay.com/get/g5f4291bfdb57cfad4e5d31219c9e866f216bb8d154036bef29bd09ee65081380b00b958364f9338f9ba28f75b5fa4008_640.jpg"].map((function(e){return{url:e,rotation:0}})),index:0};function w(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"rotateImage":return Object(s.a)(Object(s.a)({},e),{},{images:e.images.map((function(n,r){return r===I(e.index,e.images.length)?Object(s.a)(Object(s.a)({},n),{},{rotation:n.rotation+t.payload}):n}))});case"setImages":return Object(s.a)(Object(s.a)({},e),{},{index:0,images:t.payload});case"nextImage":return Object(s.a)(Object(s.a)({},e),{},{index:e.index+1});case"prevImage":return Object(s.a)(Object(s.a)({},e),{},{index:e.index-1});case"setAppUser":return Object(s.a)(Object(s.a)({},e),{},{user:t.payload});default:return e}}function k(e){var t;return null!==(t=e.images[I(e.index,e.images.length)])&&void 0!==t?t:{url:void 0,rotation:45}}function I(e,t){return(e%t+t)%t}var U=n(4);var S=Object(i.b)((function(e){return{image:k(e)}}))((function(e){return e.image.url?Object(U.jsx)("img",{src:e.image.url,style:{transform:"rotate(".concat(e.image.rotation,"deg)"),borderWidth:"2px",borderStyle:"solid"},alt:"logo"}):null})),C=n(19),L=Object(i.b)(null,{rotateImage:function(){return{type:"rotateImage",payload:15}},next:function(){return{type:"nextImage"}},prev:function(){return{type:"prevImage"}},loadImages:function(e,t){return{type:"loadImages",payload:{size:t,term:e}}}})((function(e){var t=e.rotateImage,n=e.prev,a=e.next,c=Object(C.h)(),o=c.term,i=c.size;return Object(r.useEffect)((function(){e.loadImages(o,i)}),[o,i]),Object(U.jsxs)("div",{className:"image-controls",children:[Object(U.jsx)("button",{onClick:n,children:"Previous"}),Object(U.jsx)("button",{onClick:t,children:"Rotate"}),Object(U.jsx)("button",{onClick:a,children:"Next"})]})})),z=n(390),F=n(379),R=n(389),T=n(382),E=n(387),N=n(383),q=n(109),D={gross:function(e){var t;return["slime","slug"].includes(null!==(t=null===e||void 0===e?void 0:e.trim())&&void 0!==t?t:"")?"No gross stuff please":void 0}};var P=function(e){var t,n,r,a,c=Object(C.f)(),o=Object(q.b)(),i=o.handleSubmit,u=(o.register,o.formState),l=o.control,d=u.errors;return Object(U.jsxs)("form",{onSubmit:i((function(e){return c.push("/photos/".concat(e.term,"/").concat(e.size))})),className:"search-form",children:[Object(U.jsxs)(z.a,{fullWidth:!0,margin:"normal",children:[Object(U.jsx)(F.a,{variant:"h5",children:"Search for:"}),Object(U.jsx)(q.a,{name:"term",control:l,defaultValue:"",rules:{required:!0,minLength:3,validate:D},render:function(e){var t=e.field;return Object(U.jsx)(R.a,Object(s.a)({},t))}}),Object(U.jsxs)(T.a,{children:[(null===(t=d.term)||void 0===t?void 0:t.message)?Object(U.jsx)(U.Fragment,{children:null===(n=d.term)||void 0===n?void 0:n.message}):void 0,"minLength"===(null===(r=d.term)||void 0===r?void 0:r.type)&&Object(U.jsx)(U.Fragment,{children:"Term must be at least 3 characters"}),"required"===(null===(a=d.term)||void 0===a?void 0:a.type)&&Object(U.jsx)(U.Fragment,{children:"Term is required"})]})]}),Object(U.jsxs)(z.a,{fullWidth:!0,margin:"normal",children:[Object(U.jsx)(F.a,{variant:"h5",children:"Image size:"}),Object(U.jsx)(q.a,{name:"size",rules:{required:!0},defaultValue:"web",control:l,render:function(e){var t=e.field;return Object(U.jsxs)(E.a,Object(s.a)(Object(s.a)({native:!0},t),{},{children:[Object(U.jsx)("option",{value:"preview",children:"preview"}),Object(U.jsx)("option",{value:"web",children:"web"}),Object(U.jsx)("option",{value:"large",children:"large"})]}))}})]}),Object(U.jsx)(N.a,{type:"submit",variant:"contained",color:"primary",children:"Search"})]})},W=n(54),Y=function(){var e=Object(C.h)().term;return Object(U.jsxs)(U.Fragment,{children:[Object(U.jsxs)("p",{children:["You searched for ",Object(U.jsx)("b",{children:e})," "]}),Object(U.jsx)(W.b,{to:"/search",children:"Search for something else "})]})},_=n(388),B=n(384),M=Object(i.b)((function(e){return{user:e.user}}))((function(e){var t,n,r=e.user,a=Object(C.g)(),c=Object(C.f)(),o=null!==(t=null===r||void 0===r?void 0:r.permissions)&&void 0!==t?t:[];return Object(U.jsxs)(_.a,{value:null!==(n=a.pathname.split("/")[1])&&void 0!==n?n:"search",children:[o.includes("photo:search")?Object(U.jsx)(B.a,{label:"Search",value:"search",onClick:function(){return c.push("/search")}}):null,o.includes("photo:view")?Object(U.jsx)(B.a,{label:"Photos",value:"photos",disabled:!0}):null,null!=r?Object(U.jsx)(B.a,{label:Object(U.jsxs)("div",{className:"user-profile",children:[Object(U.jsx)("img",{src:r.picture,className:"user-picture",alt:r.name}),Object(U.jsx)("a",{href:"#",onClick:function(){return c.push("/logout")},children:"Log out"})]})}):Object(U.jsx)(B.a,{label:"Log in",value:"login",onClick:function(){return c.push("/login")}})]})})),A=n(44),H=function(){return Object(r.useEffect)((function(){Object(b.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O();case 2:return t=e.sent,e.next=5,t.loginWithRedirect();case 5:case"end":return e.stop()}}),e)})))()}),[]),Object(U.jsx)("p",{children:"Redirecting to log in"})},J=Object(i.b)((function(e){return{user:e.user}}),{loadUser:function(){return{type:"loadUser"}}})((function(e){var t=e.loadUser,n=e.user,a=Object(C.f)(),c=Object(C.g)(),o=Object(r.useState)(null),i=Object(A.a)(o,2),s=i[0],u=i[1];return Object(r.useEffect)((function(){if(null!=n)return window.history.replaceState(null,"","/#/".concat(c.pathname)),void a.push("/search")}),[n]),Object(r.useEffect)((function(){Object(b.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O();case 2:e.sent.handleRedirectCallback().then((function(){t()})).catch((function(e){return u(e)}));case 4:case"end":return e.stop()}}),e)})))()}),[]),s?Object(U.jsxs)("p",{children:["Log in failed. Error: ",s.message]}):Object(U.jsxs)("p",{children:["You have logged in. Click ",Object(U.jsx)(W.b,{to:"/search",children:"here"})," to search for photos"]})})),V=function(){return Object(r.useEffect)((function(){Object(b.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O();case 2:e.sent.logout();case 4:case"end":return e.stop()}}),e)})))()}),[]),Object(U.jsx)("div",{children:"Logging out"})};var G=Object(i.b)((function(e){return{user:e.user}}),{loadUser:function(){return{type:"loadUser"}},loadImages:function(){return{type:"loadImages",payload:{term:"tiger",size:"preview"}}}})((function(e){var t=e.user,n=e.loadUser;return Object(r.useEffect)((function(){n()}),[]),Object(U.jsxs)(W.a,{children:[Object(U.jsx)(M,{}),Object(U.jsxs)(C.c,{children:[Object(U.jsx)(C.a,{path:"/login/callback",children:Object(U.jsx)(J,{})}),Object(U.jsx)(C.a,{path:"/login",children:Object(U.jsx)(H,{})}),Object(U.jsx)(C.a,{path:"/logout/callback",children:"You have logged out"}),Object(U.jsx)(C.a,{path:"/logout",children:Object(U.jsx)(V,{})}),Object(U.jsx)(C.a,{path:"/photos/:term/:size",render:function(e){var n;return(null!==(n=null===t||void 0===t?void 0:t.permissions)&&void 0!==n?n:[]).includes("photo:view")?Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)(S,{}),Object(U.jsx)(L,{}),Object(U.jsx)(Y,{})]}):Object(U.jsx)("div",{children:"You don't have permission to view photos"})}}),Object(U.jsx)(C.a,{path:"/search",render:function(e){var n;return(null!==(n=null===t||void 0===t?void 0:t.permissions)&&void 0!==n?n:[]).includes("photo:search")?Object(U.jsx)(P,{}):Object(U.jsx)("div",{children:"You don't have permission to search photos"})}}),Object(U.jsx)(C.a,{path:"*",children:"Nothing to see here."})]})]})})),Q=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,392)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),r(e),a(e),c(e),o(e)}))},K=function(e){return"http://localhost:8080/photos/".concat(encodeURIComponent(e))};function X(){return(X=Object(b.a)(f.a.mark((function e(t){var n,r,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g();case 2:return n=e.sent,e.next=5,fetch(K(t),{headers:{Authorization:"Bearer ".concat(null===n||void 0===n?void 0:n.authToken)}});case 5:return r=e.sent,e.next=8,r.json();case 8:return a=e.sent,e.abrupt("return",a);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Z={loadImages:function(e){return X.apply(this,arguments)},loadUser:g},$=n(386),ee=n(210);$.a({dsn:"https://aa0edea63055490f9f55e6cbe7fc9a7b@o913027.ingest.sentry.io/5850497",integrations:[new ee.a.BrowserTracing],tracesSampleRate:1});var te=function(e){var t=Object(d.a)(),n=Object(u.createStore)(w,y,Object(l.composeWithDevTools)(Object(u.applyMiddleware)(t))),r=function(e){var t=f.a.mark(a),n=f.a.mark(c),r=f.a.mark(s);function a(e){var n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(h.a)(o,e.payload);case 2:return n=t.sent,t.next=5,Object(h.b)({type:"setImages",payload:n});case 5:case"end":return t.stop()}}),t)}function c(){var e;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(h.a)(g);case 2:if(null==(e=t.sent)){t.next=6;break}return t.next=6,Object(h.b)({type:"setAppUser",payload:e});case 6:case"end":return t.stop()}}),n)}function o(e){return i.apply(this,arguments)}function i(){return(i=Object(b.a)(f.a.mark((function t(n){var r,a,c,o;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.term,a=n.size,t.next=3,e.loadImages(r);case 3:return c=t.sent,o=c.hits.map((function(e){return{url:"web"===a?e.webformatURL:"large"===a?e.largeImageURL:e.previewURL,rotation:0}})),t.abrupt("return",o);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function s(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.c)("loadImages",a);case 2:return e.next=4,Object(h.c)("loadUser",c);case 4:case"end":return e.stop()}}),r)}return s}(e);return t.run(r),n}(Z);o.a.render(Object(U.jsx)(a.a.StrictMode,{children:Object(U.jsx)(i.a,{store:te,children:Object(U.jsx)(G,{borderColour:"blue"})})}),document.getElementById("root")),Q()}},[[344,1,2]]]);
//# sourceMappingURL=main.cd5920b2.chunk.js.map